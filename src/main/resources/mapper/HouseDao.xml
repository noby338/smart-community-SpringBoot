<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.woniuxy.smart_community.dao.HouseDao">

    <!--配置数据库别名-->
    <resultMap type="com.woniuxy.smart_community.entity.House" id="HouseMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="building" column="building" jdbcType="INTEGER"/>
        <result property="unit" column="unit" jdbcType="INTEGER"/>
        <result property="floor" column="floor" jdbcType="INTEGER"/>
        <result property="houseNum" column="house_num" jdbcType="VARCHAR"/>
        <result property="housePeopleNums" column="house_people_nums" jdbcType="INTEGER"/>
        <result property="houseState" column="house_state" jdbcType="INTEGER"/>
    </resultMap>

    <!--新增房间数据-->
    <insert id="insertHouse">
        insert into house(id, building, unit, floor, house_num, house_people_nums, house_state)
        values (#{house.id}, #{house.building}, #{house.unit}, #{house.floor}, #{house.houseNum}, #{house.housePeopleNums}, #{house.house_state})
    </insert>

    <!--通过主键删除房间信息数据-->
    <delete id="deleteHouseById">
        delete from house where id = #{id}
    </delete>

    <!--通过主键修改房间信息数据-->
    <update id="updateHouse">
        update house
        <set>
            <if test="house.building != null and house.building != ''">
                building = #{house.building},
            </if>
            <if test="house.unit != null and house.unit != ''">
                unit = #{house.unit},
            </if>
            <if test="house.floor != null and house.floor != ''">
                floor = #{house.floor},
            </if>
            <if test="house.houseNum != null and #{house.houseNum} != ''">
                house_num = #{house.houseNum},
            </if>
            <if test="house.housePeopleNums != null and house.housePeopleNums != ''">
                house_people_nums = #{house.housePeopleNums},
            </if>
            <if test="house.houseState != null and house.houseState != ''">
                house_state = #{house.houseState}
            </if>
        </set>
        where id = #{house.id}
    </update>

    <!--通过房间信息查询相关数据-->
    <select id="selectHouseByHouseInfo" resultMap="HouseMap">
        select * from house
        <where>
            <if test="house.id != null">
                and id = #{house.id}
            </if>
            <if test="house.building != null">
                and building = #{house.building}
            </if>
            <if test="house.unit != null ">
                and unit = #{house.unit}
            </if>
            <if test="house.floor != null">
                and floor = #{house.floor}
            </if>
            <if test="house.houseNum != null and house.houseNum != ''">
                and house_num = #{house.houseNum}
            </if>
            <if test="house.housePeopleNums != null">
                and house_people_nums = #{house.housePeopleNums}
            </if>
            <if test="house.houseState != null and house.houseState != ''">
                and house_state = #{house.houseState}
            </if>
        </where>
    </select>

    <!--根据房间信息统计总行数-->
    <select id="countHouses" resultType="integer">
        select count(*)
        from house
        <where>
            <if test="house.id != null">
                and id = #{house.id}
            </if>
            <if test="house.building != null">
                and building = #{house.building}
            </if>
            <if test="house.unit != null ">
                and unit = #{house.unit}
            </if>
            <if test="house.floor != null">
                and floor = #{house.floor}
            </if>
            <if test="house.houseNum != null and house.houseNum != ''">
                and house_num = #{house.houseNum}
            </if>
            <if test="house.housePeopleNums != null">
                and house_people_nums = #{house.housePeopleNums}
            </if>
            <if test="house.houseState != null">
                and house_state = #{house.houseState}
            </if>
        </where>
    </select>
</mapper>

