<?xml version="1.0" encoding="UTF-8" ?>
<!-- XML约束头:MyBatis的约束文件使用的dtd，规范这个XML文档处理 遵守XML的一般规则以外，要遵守的自定义规则:能够使用哪些标签，使用哪些属性，出现的次数，标签的先后属性 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- mapper是映射文件的根节点 namespace属性：名称空间，命名空间.就是一个名字 现在可以任意，以后使用接口的全限定名 -->
<mapper namespace="com.woniuxy.smart_community.dao.CarInfoDao">
<!--查询-->
    <select id="selectAllCarInfos" resultMap="carInfoMapper">
        select * from car_info
    </select>

    <select id="selectCarInfoByCarid" resultMap="carInfoMapper">
        select * from car_info where carid=#{carId}
    </select>

    <select id="selectCarInfoByCarno" resultMap="carInfoMapper">
        select * from car_info where carno like '%' #{carNo} '%'
    </select>



    
<!--添加-->
    <insert id="insertCarInfo">
        insert into car_info values(null,
        #{carInfo.carNo},#{carInfo.carJpg},#{carInfo.parkId},#{carInfo.owId},1)
    </insert>


<!--修改-->
    <update id="updateCarInfoState">
        update car_info set carstate=#{carState} where carid=#{carId}
    </update>


<!--删除-->
    <delete id="deleteCarInfoByCarid">
        delete car_info where carid=#{carId}
    </delete>


<!--共用功能-->

    <resultMap id="carInfoMapper" type="carInfo">
        <id column="carid" property="carId"/>
        <result column="carno" property="carNo"/>
        <result column="carjpg" property="carJpg"/>
        <result column="carstate" property="carState"/>
        <association property="parkingInfo" javaType="parkingInfo" column="parkid" select="selectParkingInfoByParkId"/>
        <association property="ownersInfo" javaType="ownersInfo" column="owid" select="selectOwnersInfoByOwId"/>
    </resultMap>
    <select id="selectParkingInfoByParkId" resultType="parkingInfo">
        select * from parking_info where parkid=#{parkid}
    </select>
    <select id="selectOwnersInfoByOwId" resultType="ownersInfo">
        select * from owners_info where owid=#{owid}
    </select>



</mapper>
